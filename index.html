<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Riftwalk</title>
    <link rel="stylesheet" href="css/riftwalk.css">
    <link rel="stylesheet" href="css/bulma.min.css">
    <link rel="stylesheet" href="css/font-awesome.min.css">
</head>
<script src="socket.io.js"></script>
<script src="events.js"></script>
<script src="riftwalk.js"></script>
<script src="vue.js"></script>
<body onload="DOMready()">
    <!-- <img src="img/close.png" class="close-icon" style=""> -->
    <div id="app">
        <div class="no-drag close-icon" @click="close"></div>
        <section class="section" id="firstTimeSetup" v-if="firstTime" style="padding-top: 30px;">
            <div class="container" :style="{left: (step == 1) ? '0px' : '-500px', transition: 'left 0.3s'}">
                <h1 class="title league-text" v-bind:style="{opacity: titleOpacity, transition: 'opacity 0.2s'}">
                    Welcome to Riftwalk!
                </h1>
                <p class="subtitle league-text" v-bind:style="{opacity: subtitleOpacity, transition: 'opacity 0.5s', 'font-size': '1.1rem !important'}">
                    We'll help you get started with this companion app.
                </p>
                <div v-bind:style="{opacity: actionOpacity, transition: 'opacity 0.5s'}">
                  <p class="league-text">Select your League of Legends {{platform == "darwin" ? ".app file" : "directory"}}</p>
                  <section class="section" style="background-color: #1E2327; padding: 1em;">
                    <div class="container">

                      <nav class="level is-mobile">
                        <!-- Left side -->
                        <div class="level-left">
                          <div class="level-item">
                            <p class="" style="width: 280px;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;">
                              {{client.gameDirectory ? client.gameDirectory : directoryMessage}}
                            </p>
                          </div>
                        </div>

                        <!-- Right side -->
                        <div class="level-right">
                          <p class="level-item"><a class="no-drag button is-light" @click="selectDirectory()">Browse</a></p>
                        </div>
                      </nav>
                    </div>
                  </section>
                  <a class="no-drag button is-info" style="margin-left: auto;margin-right: auto;position: relative;display: inherit;top: 15px;width: 220px;" :disabled="!client.gameDirectory" @click="next()">Next</a>
                </div>
            </div>
            <div class="container" :style="{left: (step == 2) ? '0px' : '500px', transition: 'left 0.3s', top: '-211px'}">
                <h1 class="title league-text" :style="{opacity: titleOpacity, transition: 'opacity 0.2s'}">
                    Step 2
                </h1>
                <p class="subtitle league-text" :style="{opacity: subtitleOpacity, transition: 'opacity 0.5s'}">
                    Connect your smartphone
                </p>
                <section class="section" style="background-color: #1E2327; padding: 1em;">
                  <div :class="{loader: !code}" class="container" style="font-size: 42px; text-align: center;">
                      {{code}}
                  </div>
                </section>
                <p class="league-text" style="margin-top: 1.5rem;text-align: center;" :style="{opacity: (code ? 1 : 0),  transition: 'opacity 0.5s'}">
                    Enter this code in your mobile app to continue
                </p>
            </div>
        </section>
    </div>
</body>
<script src="ui.js"></script>
<script>

    window.addEventListener('DOMMouseScroll', function(e) {
        e.preventDefault();
    }, false);

    function DOMready() {
        if (localStorage.getItem('completedSetup') != true) {
            localStorage.clear()
            client.gameDirectory = null
        }
        //selectDirectory()
        validateDirectory((success) => {
          if (success){
            client.lockFileInterval = setInterval(checkLeagueClientOpen, LOCK_FILE_RATE)
            connectToAPI()
          }
          else {
            ui.startSetup()
          }
        })
    }
</script>

</html>
